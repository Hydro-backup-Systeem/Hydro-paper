\documentclass[conference]{IEEEtran}

% Note: 
% The layout of this tex file was generated by GenAI (chatgpt), based on a picture of the template provided for this paper.

% ------------------------------------------------------------
% PAGE LAYOUT
% ------------------------------------------------------------
\usepackage[paperwidth=210mm,paperheight=297mm,
            left=20mm, right=15mm, top=25mm, bottom=20mm,
            columnsep=5mm]{geometry}

% ------------------------------------------------------------
% FONTS & ENCODING
% ------------------------------------------------------------
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{times}                % Times New Roman-like text
\usepackage{microtype}            % better justification

% ------------------------------------------------------------
% SECTION TITLES
% ------------------------------------------------------------
\usepackage{titlesec}
% Sections in SMALL CAPS, 12pt, centered
\titleformat*{\section}{\normalfont\scshape\centering\small}
\titleformat*{\subsection}{\normalfont\bfseries\small}

% ------------------------------------------------------------
% ABSTRACT & KEYWORDS
% ------------------------------------------------------------
\usepackage{abstract}
\renewcommand{\abstractnamefont}{\normalfont\bfseries\small}  % "Abstract"
\renewcommand{\abstracttextfont}{\normalfont\itshape\small}   % body
\setlength{\absleftindent}{0pt}
\setlength{\absrightindent}{0pt}

\newcommand{\keywords}[1]{%
  \vspace{1ex}\par\noindent%
  \textbf{Keywords—}\small #1%
}

% ------------------------------------------------------------
% CAPTIONS
% ------------------------------------------------------------
\usepackage[font=small,labelfont=bf,labelsep=period,justification=centering]{caption}

% ------------------------------------------------------------
% TEXT
% ------------------------------------------------------------
\usepackage[utf8]{inputenc}
\usepackage{enumitem}

% ------------------------------------------------------------
% GRAPHICS
% ------------------------------------------------------------
\usepackage{float}
\usepackage{graphicx}

% ------------------------------------------------------------
% HYPERREF (optional)
% ------------------------------------------------------------
\usepackage[hidelinks]{hyperref}
\usepackage[
  separate-uncertainty = true,
  multi-part-units = repeat
]{siunitx}

% ------------------------------------------------------------
% TITLE BLOCK
% ------------------------------------------------------------
\makeatletter
\renewcommand\maketitle{%
  \begin{center}
    \small\itshape
    Engineering Experiences\,3, Electronics-ICT,\quad May 2025,\quad Bruges, Belgium
  \end{center}
  \vspace{2ex}

  \begin{center}
    {\fontsize{22}{24}\selectfont\bfseries\@title\par}      % Title
    \vspace{1.5ex}
    {\fontsize{14}{16}\selectfont
       Jarno Mechele\quad Joey De Smet\quad Robijn Ameye\par
    }
    \vspace{1ex}
    {\fontsize{9}{11}\selectfont
      Faculty of Engineering Technology, KU Leuven - Bruges Campus\\
      Spoorwegstraat\,12, 8200 Bruges, Belgium\\
      \{jarno.mechele, joey.desmet, robijn.ameye\}@student.kuleuven.be%
    }
    \vspace{2ex}
  \end{center}%
}
\makeatother

% ------------------------------------------------------------
% DOCUMENT
% ------------------------------------------------------------
\begin{document}

\twocolumn[{
  \date{May--2025}
  \title{Low-energy backup communication system for hydrogen racecar}
  \maketitle
}]

% TODO
\begin{abstract}
% The abstract is a brief (50--80 words) synopsis of the paper. Use up to 5 keywords.
%Summary of the research and conclusion, Problem, method, results, conclusion....

This paper presents a low-energy backup communication system for a hydrogen-powered racecar, 
combining LoRa wireless communication with speech synthesis and WAV playback on an STM32U5 microcontroller. 
A custom Flutter application with a C++ backend enables the pit team to send and receive messages to the racecar. 
The system consumes just 382\,mW during transmission and achieved a 440\,m range—suitable for small tracks. 
It provides a reliable, encrypted, and energy-efficient fallback, with future work aimed at extending communication range.

\end{abstract}

%TODO
\keywords{Low power, Long-range wireless, Embedded systems}

\section{Introduction}
In hydrogen-powerd endurance racing, uninterupted telmetry and communication between the pitwall and the car are essential for both competitive performance and for driver safety. As systems could fail due to multiple reasons, and cause a loss of communication costing laps or even endager lives, a dedicated low-power backup is required. This paper therefore proposes a long-range wireless solution capable of transmitting and receiving both critiacal sensor data and messages to the driver over distances up to 2km (the approximate diameter of the Le Mans circuit) while only consuming a few milliwatts. By combining a encrypted LoRa-based RF link with embedded speech synthesis and WAV playback on an ultra-low-power STM32U5 microcontroller, our design ensures that even in the event of primary-system failure, the pit-crew retains awareness of the car's most critical data and issue instructions to the driver.

%\section{Overall system design}


\input{chapters/firmware}
\input{chapters/software}
\input{chapters/hardware}

\section{Testing}

\subsection{Test Setup}
The system was evaluated primarily in a laboratory environment. Key aspects such as power consumption, LoRa communication integrity, and audio output functionality were tested. Most tests were conducted manually, involving the transmission of periodic test messages and monitoring system responses via serial output and audio feedback. Power draw was observed using an inline current measurement tool, and LoRa transmissions were validated using logic analyzers and debug logs.

\subsection{Communication Testing}
To verify LoRa communication, encrypted packets were periodically transmitted and received between two system nodes. Tests confirmed successful decryption, CRC validation, and end-to-end data integrity.

\subsection{Audio Output Testing}
WAV file playback was validated by connecting the system's analog output to external speakers and assessing the clarity of preloaded audio samples. Speech synthesis was tested by transmitting predefined sentences to the device and evaluating intelligibility through blind listening tests. Testers rated intelligibility qualitatively. While overall clarity was sufficient for basic commands, future improvements may include tuning output filters and optimizing speech synthesis parameters for better naturalness.

\subsection{Audio Input Testing}

\subsection{Power measuring}

After connecting the microphone, an oscilloscope was used to verify that the audio waveform was properly amplified and routed to the ADC.
The ADC includes an onboard crystal oscillator that generates a clock signal, causing it to continuously transmit data.
All I²S bus data lines were probed and analyzed using the oscilloscope.
These measurements confirmed the correct operation of the I²S interface.

\subsection{LoRa on PCB}

range limited to 440m ?

\subsection{Power measurement}

\subsubsection{LoRa power consumption}

Power consumption was measured during transmission at maximum output power.  
For comparison, NB-IoT, a wireless protocol with similar range, is considered.  
LoRa shows significantly lower power consumption than NB-IoT.  
External data indicate that NB-IoT consumes about 65\% more energy than LoRa~\cite{Lora-nbiot_paper}.  

The measured power consumption of the LoRa device is shown in Table~\ref{tab:power_consumption}.

\begin{table}[h]
  \centering
  \caption{Power consumption in different states}
\label{tab:power_consumption}
  \begin{tabular}{|c|c|c|}
    \hline
    \textbf{idle} & \textbf{receiving} & \textbf{sending} \\
    \hline
    5.8 mW & 38.3 mW & 382 mW \\
    \hline
  \end{tabular}
\end{table}

\subsubsection{Power supply efficiency}

Due to testing issues and time constraints, it was not possible to measure the efficiency of the buck converter.
Therefore, only data provided by the manufacturer can be referenced. These values are listed in Table~\ref{tab:power_suply_table}~\cite{TPS629203}.

\begin{table}[h]
  \centering
  \caption{Efficiency based on current consumption}
 \label{tab:power_suply_table}
  \begin{tabular}{|c|c|c|}
    \hline
    \textbf{0.1 mA} & \textbf{1 mA} & \textbf{10 mA} \\
    \hline
    75\% & 87\% & 89\% \\
    \hline
  \end{tabular}
\end{table}

\subsubsection{Audio power consumption}

lorem dat niet werkt


\section{Conclusion}

\section*{Acknowledgment}
The authors would like to thank the supervising professors for their guidance throughout the development of this project. Special thanks go to the Hydro Team KU Leuven for providing valuable context and support related to the vehicle's communication needs. 

Additionally, the authors used generative AI tools to assist with language refinement and grammar correction during the preparation of this paper.

\input{chapters/bibliography}

\end{document}
